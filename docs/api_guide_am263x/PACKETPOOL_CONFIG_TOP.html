<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<title>AM263x MCU+ SDK: Ethernet Packet Pool Allocation Guidelines</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
  /* @license-end */
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="AM263x MCU+ SDK"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AM263x MCU+ SDK
   &#160;<span id="projectnumber">11.00.00</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.html" method="get">
              <img id="MSearchSelect" src="search/mag.svg" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('PACKETPOOL_CONFIG_TOP.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Ethernet Packet Pool Allocation Guidelines </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_components_networking_enet_lld_packet_pool_config"></a></p>
<p>Enet Driver creates memory for Ethernet packets based on configuration from "Packet Pool Config". To use various packet pools like Large, Medium and Small, the SysConfig GUI tool configuration has to be manually configured. The application can only allocate the Ethernet Packet memory available from SysConfig GUI configuration. If application tries to allocate packet pool which is not configured from SysConfig GUI tool, then assertion check in application will fail due to non-availability of Ethernet packet memory.</p>
<p>By default, networking out-of-box examples enable "Packet pool allocation" from SysConfig GUI tool and "EnetMem_allocEthPkt()" from application to allocate memory for Ethern et packets. Users are free to disable "Packet Po0l Allocation" from GUI and write their own "EnetMem_allocEthPkt()" to allocate memory.  <style>div.image img[src="disable_packetpool.png"]{width:35%}</style> </p><div class="image">
<img src="disable_packetpool.png" alt=""/>
<div class="caption">
Syscfg GUI with "Packet pool allocation" disabled </div></div>
<p>In the below configuration(Figure1), only Medium Pool count is non-zero(32), Large and Small pool count is configured to be zero. So the Application can only allocate Medium packet pool for Tx,Rx DMA Ethernet packet queues. When application tries to allocate Large packet size Queues, then assertion check in application will fail.  <style>div.image img[src="syscfg_packetpool_mediumpool.png"]{width:35%}</style> </p><div class="image">
<img src="syscfg_packetpool_mediumpool.png" alt=""/>
<div class="caption">
Figure1: Packet pool configuration with only Medium Pool Configured</div></div>
<p>Non-Lwip Examples use "EnetMem_allocEthPkt()" API to allocate Ethernet packet queue for Tx,Rx DMA in the application. Total Scatter segment size(scatterSegments[]) which is given as argument to "EnetMem_allocEthPkt()" should be less than or equal to the Packet pool type configured from the SysConfig GUI tool. With the above packet pool configuration(Figure1), ethernet packet size less than or equal to 512 Bytes(Medium packet pool size) can be allocated and ethernet packet size more than 512 Bytes cannot be allocated in application. User has to manually change the scattersegments[](ENET_MEM_MEDIUM_POOL_PKT_SIZE in Figure2) and Ethernet packet queue count(ENET_SYSCFG_TOTAL_NUM_RX_PKT in Figure2) based on the usecase. Ethernet packet which has to be allocated in the application should be in the range of packet pool configured from SysConfig GUI tool.</p>
<p> <style>div.image img[src="packet_pool_allocEthPkt.png"]{width:30%}</style> </p><div class="image">
<img src="packet_pool_allocEthPkt.png" alt=""/>
<div class="caption">
Figure2: EnetMem_allocEthPkt() API usage in Application to allocate Ethernet packet memory</div></div>
 <dl class="section note"><dt>Note</dt><dd>Make sure to update the arguments of "EnetMem_allocEthPkt()" API in application when the packet pool configuration is updated from SysConfig GUI tool</dd></dl>
<p>Lwip Examples by default uses Large Pkt pool for Rx DMA Packet Queues. Users cannot set the 'Large Packet Pool Count' to 'Zero' in the default packet pool configuration.</p>
<p>If user wants to change the "Large pool count" to "0", then the "Rx Packet Buffer Size" size has to be updated with subsequent pool size whose count is Non-zero.</p>
<p>In the following configuration(Figure3), "Large Packet Pool Count" configured to "Zero" and "Medium Packet Pool Count" to "32". To use this configuration, the "Rx Packet Buffer Size" is updated to "512" Bytes from the default value of "1536"Bytes</p>
<p> <style>div.image img[src="updated_lwip_packet_pool.png"]{width:30%}</style> </p><div class="image">
<img src="updated_lwip_packet_pool.png" alt=""/>
<div class="caption">
Figure3: Sample Packet pool configuration to change the default configuration for LWIP Examples</div></div>
<p>To transmit Ethernet packet, LWIP applciation uses memory pool configuration from "enet/lwippools.h" to allocate buffer memory. User can update following configuration from "enet/lwippools.h" based on the usecase.  <style>div.image img[src="lwippool.png"]{width:20%}</style> </p><div class="image">
<img src="lwippool.png" alt=""/>
<div class="caption">
Figure4: Lwip pool memory configuration(lwipools.h) used for Tx LWIP Packets from EVM</div></div>
 </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
