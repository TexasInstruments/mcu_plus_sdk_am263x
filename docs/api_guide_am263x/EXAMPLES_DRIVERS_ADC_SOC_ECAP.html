<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<title>AM263x MCU+ SDK: ADC SOC ECAP</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
  /* @license-end */
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="AM263x MCU+ SDK"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AM263x MCU+ SDK
   &#160;<span id="projectnumber">11.00.00</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.html" method="get">
              <img id="MSearchSelect" src="search/mag.svg" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('EXAMPLES_DRIVERS_ADC_SOC_ECAP.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">ADC SOC ECAP </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md2077">Introduction</a><ul><li class="level2"><a href="#autotoc_md2078">ECAP Configurations</a></li>
<li class="level2"><a href="#autotoc_md2079">ADC Configurations</a></li>
<li class="level2"><a href="#autotoc_md2080">ISRs</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md2081">External Connections</a><ul><li class="level2"><a href="#autotoc_md2082">AM263x-CC E2 or AM263Px-CC E2 or AM261x-SOM E1:</a></li>
<li class="level2"><a href="#autotoc_md2083">AM263x-LP :</a></li>
<li class="level2"><a href="#autotoc_md2084">AM261x-LP :</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md2085">Watch Variables</a></li>
<li class="level1"><a href="#EXAMPLES_DRIVERS_ADC_SOC_ECAP_COMBOS">Supported Combinations</a></li>
<li class="level1"><a href="#autotoc_md2086">Steps to Run the Example</a></li>
<li class="level1"><a href="#autotoc_md2087">See Also</a></li>
<li class="level1"><a href="#autotoc_md2088">Sample Output</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_examples_drivers_adc_soc_ecap"></a></p>
<h1><a class="anchor" id="autotoc_md2077"></a>
Introduction</h1>
<p>This example demostrates how the ECAP and ADC to be configured so that the ADC SOC can be triggered from the ECAP Events. The ECAP can trigger the ADC SOC Conversions in its both Capture mode and APWM mode.</p><ul>
<li>In ECAP Capture Mode, the CAPEVTx [x= 1 to 4] can be used and</li>
<li>In ECAP APWM Mode, The counter match to Compare or Period can be used.</li>
</ul>
<p>The example configures an ECAP (APWM_ECAP) to be in the APWM mode and generate an PWM waveform, and another ECAP (CAPTURE_ECAP) to be in Capture mode to recieve the PWM generated from the APWM_ECAP, via GPIO and InputXbar. Also, 2 ADCs ADC_APWM_TRIG, ADC_CAP_TRIG are configured to recieve triggers from the APWM_ECAP and CAPTURE_ECAP respectively. Both ADCs generate Interrupt at the EOCs and trigger respective App_adcISR. The ISRs are used for result reading and validation purpose of the example via incrementing a ISR count variable.</p>
<p> <style>div.image img[src="am263_adc_soc_ecap.png"]{width:50%}</style> </p><div class="image">
<img src="am263_adc_soc_ecap.png" alt=""/>
<div class="caption">
Example Block diagram</div></div>
<h2><a class="anchor" id="autotoc_md2078"></a>
ECAP Configurations</h2>
<ol type="1">
<li>APWM_ECAP :</li>
</ol>
<ul>
<li>generate a PWM wave of 5 KHz with 50% duty cycle.</li>
<li>generate an ADC SOC trigger at its compare match (i.e, 5KHz triggers)</li>
</ul>
<ol type="1">
<li>CAPTURE_ECAP :</li>
</ol>
<ul>
<li>recieve 2 edges, 1 rising then 1 falling (CAPEVT1,2)</li>
<li>generate an ADC SOC trigger at CAPEVT2</li>
</ul>
<h2><a class="anchor" id="autotoc_md2079"></a>
ADC Configurations</h2>
<p>ADC_APWM_TRIG (or ADC_CAP_TRIG) :</p><ul>
<li>SOC 0 is configured to recieve trigger from the APWM_ECAP (or CAPTURE_ECAP)</li>
<li>INT 1 is generated at the EOC/SOC0</li>
<li>Prescaled at 3, with Sample and Hold window of 18, configuring for 4MSPS on ADC. </li>
</ul>
<h2><a class="anchor" id="autotoc_md2080"></a>
ISRs</h2>
<p>App_apwmTrigAdcISR (or App_capTrigAdcISR)</p><ul>
<li>ADC INT 1 from ADC_APWM_TRIG (or ADC_CAP_TRIG) is configured via INTxBar to trigger App_apwmTrigAdcISR (or App_capTrigAdcISR).</li>
<li>Each ISR reads the respective SOC result, clears the ADC INT flags and Increments a counter for validation.</li>
</ul>
<h1><a class="anchor" id="autotoc_md2081"></a>
External Connections</h1>
<h2><a class="anchor" id="autotoc_md2082"></a>
AM263x-CC E2 or AM263Px-CC E2 or AM261x-SOM E1:</h2>
<p>Feed Analog voltages on ADC_APWM_TRIG (ADC0)</p><ul>
<li>ADC0_AIN2, i.e., HSEC PIN 15 Feed Analog voltages on ADC_CAP_TRIG (ADC1)</li>
<li>ADC1_AIN0, i.e., HSEC PIN 12 </li>
</ul>
<h2><a class="anchor" id="autotoc_md2083"></a>
AM263x-LP :</h2>
<p>Feed Analog voltages on ADC_APWM_TRIG (ADC0)</p><ul>
<li>ADC0_AIN2, i.e., J5/7 PIN 66 Feed Analog voltages on ADC_CAP_TRIG (ADC1)</li>
<li>ADC1_AIN0, i.e., J1/3 PIN 24 </li>
</ul>
<h2><a class="anchor" id="autotoc_md2084"></a>
AM261x-LP :</h2>
<p>Feed Analog voltages on ADC_APWM_TRIG (ADC0)</p><ul>
<li>ADC0_AIN2, i.e., J5/7 PIN 63 Feed Analog voltages on ADC_CAP_TRIG (ADC1)</li>
<li>ADC1_AIN0, i.e., J1/3 PIN 24</li>
</ul>
<h1><a class="anchor" id="autotoc_md2085"></a>
Watch Variables</h1>
<p>The below watch variables can be used to view ADC conversion results.</p><ul>
<li>gApwmTrigAdcResult[] : Digital representation of the voltage sample on pin AIN2 of ADC_APWM_TRIG</li>
<li>gCapTrigAdcResult[] : Digital representation of the voltage sample on pin AIN0 of ADC_CAP_TRIG</li>
</ul>
<h1><a class="anchor" id="EXAMPLES_DRIVERS_ADC_SOC_ECAP_COMBOS"></a>
Supported Combinations</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter  </th><th class="markdownTableHeadNone">Value   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CPU + OS  </td><td class="markdownTableBodyNone">r5fss0-0 nortos   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Toolchain  </td><td class="markdownTableBodyNone">ti-arm-clang   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Board  </td><td class="markdownTableBodyNone">am263x-cc, am263x-lp   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Example folder  </td><td class="markdownTableBodyNone">examples/drivers/adc/adc_soc_ecap/   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md2086"></a>
Steps to Run the Example</h1>
<ul>
<li><b>When using CCS projects to build</b>, import the CCS project for the required combination and build it using the CCS project menu (see <a class="el" href="CCS_PROJECTS_PAGE.html">Using SDK with CCS Projects</a>).</li>
<li><b>When using makefiles to build</b>, note the required combination and build using make command (see <a class="el" href="MAKEFILE_BUILD_PAGE.html">Using SDK with Makefiles</a>)</li>
<li>Establish connections as mentioned in External Connections section</li>
<li>Launch a CCS debug session and run the executable, see <a class="el" href="CCS_LAUNCH_PAGE.html">CCS Launch, Load and Run</a></li>
<li>Using watch variables, view the ADC conversion results.</li>
<li>View the ADC conversion results in UART console logs</li>
</ul>
<h1><a class="anchor" id="autotoc_md2087"></a>
See Also</h1>
<p><a class="el" href="DRIVERS_ADC_PAGE.html">ADC</a></p>
<h1><a class="anchor" id="autotoc_md2088"></a>
Sample Output</h1>
<p>Shown below is a sample output when the application is run,</p>
<div class="fragment"><div class="line">ADC Triggered by ECAP Test Started ...</div>
<div class="line">ADC Triggered by ECAP Test Passed</div>
<div class="line">All tests have passed!!</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
