<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<title>AM263x MCU+ SDK: EPWM Minimum Deadband</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
  /* @license-end */
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="AM263x MCU+ SDK"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AM263x MCU+ SDK
   &#160;<span id="projectnumber">11.00.00</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.html" method="get">
              <img id="MSearchSelect" src="search/mag.svg" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('EXAMPLES_DRIVERS_EPWM_MINIMUM_DEADBAND.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">EPWM Minimum Deadband </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md2352">Introduction</a></li>
<li class="level1"><a href="#autotoc_md2353">Various MDL configurations</a><ul><li class="level2"><a href="#autotoc_md2354">Add falling edge delay on same channel</a></li>
<li class="level2"><a href="#autotoc_md2355">Add rising edge delay on same channel</a></li>
<li class="level2"><a href="#autotoc_md2356">Add rising edge delay wrt falling edge of other channel of same instance</a></li>
<li class="level2"><a href="#autotoc_md2357">Add rising edge wrt rising edge of other channel  of same instance</a></li>
<li class="level2"><a href="#autotoc_md2358">Add delay wrt other channel of other instance</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md2359">External Connections</a><ul><li class="level2"><a href="#autotoc_md2360">AM263X-CC or AM263PX-CC or AM261X-SOM</a></li>
<li class="level2"><a href="#autotoc_md2361">AM263X-LP or AM263PX-LP</a></li>
<li class="level2"><a href="#autotoc_md2362">AM261X-LP</a></li>
</ul>
</li>
<li class="level1"><a href="#EXAMPLES_DRIVERS_EPWM_MINIMUM_DEADBAND_COMBOS">Supported Combinations</a></li>
<li class="level1"><a href="#autotoc_md2363">Steps to Run the Example</a></li>
<li class="level1"><a href="#autotoc_md2364">See Also</a></li>
<li class="level1"><a href="#autotoc_md2365">Sample Output</a></li>
<li class="level1"><a href="#autotoc_md2366">References</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_examples_drivers_epwm_minimum_deadband"></a></p>
<h1><a class="anchor" id="autotoc_md2352"></a>
Introduction</h1>
<p>In this example ePWM uses Minimum Deadband to do various operations on the signal coming to the MDL block.</p>
<h1><a class="anchor" id="autotoc_md2353"></a>
Various MDL configurations</h1>
<p>We will be using some terminologies like EPWMxA_DE.sclk and EPWMxA_DE. The reference diagrams at the end can be referred for understanding. Note that DEPWMA(B).sclk and EPWMxA(B)_DE.sclk are used interchangeably. Same for DEPWMA(B) and EPWMxA(B)_DE.</p>
<p>The screenshots attached in the documentation are as per the results obtained by executing the example on CC. Please note that there are some instance differences between CC and LP.</p>
<p>The mapping is such that:</p>
<p>EPWM0A(B) on CC &lt;--&gt; EPWM0A(B) on LP (EPWM7A(B) in case of AM261x-LP) <br  />
EPWM1A(B) on CC &lt;--&gt; EPWM1A(B) on LP <br  />
EPWM2A(B) on CC &lt;--&gt; EPWM2A(B) on LP <br  />
EPWM3A(B) on CC &lt;--&gt; EPWM3A(B) on LP <br  />
EPWM4A(B) on CC &lt;--&gt; EPWM9A(B) on LP (EPWM4A(B) in case of AM261x-LP) <br  />
EPWM6A(B) on CC &lt;--&gt; EPWM12A(B) on LP (EPWM6A(B) in case of AM261x-LP) <br  />
 </p>
<h2><a class="anchor" id="autotoc_md2354"></a>
Add falling edge delay on same channel</h2>
<p>We can introduce a falling edge delay on the same signal.</p>
<p> <style>div.image img[src="am263_epwm_mdl_fed.PNG"]{width:60%}</style> </p><div class="image">
<img src="am263_epwm_mdl_fed.PNG" alt=""/>
<div class="caption">
Figure 1.a EPWM showing falling edge delay on same channel</div></div>
<p>In our example, EPWM3A is used as the reference for comparing with EPWM2A. EPWM3A has all configurations same as EPWM2A but with MDL disabled.</p>
<ol type="1">
<li>Enable MINBCFG[ENABLEA] = 1</li>
<li>Select MINDBCFG[SELA] = 0 i.e. EPWMxA_DE.sclk</li>
<li>MINDBCFG[INVERTA] = 0 i.e. no inversion of the reference signal going inside the Delay logic block</li>
<li>MINDBCFG[DELAYA] = 2000 i.e. 2000 * SYSCLK (5ns) = 10 Us (2000 * SYSCLK (4ns) = 8 Us in case of AM261X-LP)</li>
<li>Select Block A as the blocking signal. MINDBCFG[SELBLOCKA] = 0</li>
<li>MINDBCFG[POLSELA] = 1 i.e. OR EPWMxA_DE with the selected block signal (BLOCKA)</li>
</ol>
<p>The first waveform shows the signal before entering into the MINDB logic block. The second one shows the BLOCK signal which is falling edge stretched version of the reference signal. The third shows OR-ed result of BLOCK and the original signal that comes out of the MDL block. The shift in the falling edge (marked in red) is 10 Us (8 Us in case of AM261X-LP).</p>
<p>Note that there's no way to tap the first 2 waveforms from inside the block. We have configured one ePWM instance with same configuration other than the MDL enabled just for reference.</p>
<h2><a class="anchor" id="autotoc_md2355"></a>
Add rising edge delay on same channel</h2>
<p>We can introduce a rising edge delay on the same signal.</p>
<p> <style>div.image img[src="am263_epwm_mdl_red.PNG"]{width:60%}</style> </p><div class="image">
<img src="am263_epwm_mdl_red.PNG" alt=""/>
<div class="caption">
Figure 2.a EPWM showing rising edge delay on same channel</div></div>
<p>In our example, EPWM3B is used as the reference for comparing with EPWM2B. EPWM3B has all configurations same as EPWM2B but with MDL disabled.</p>
<ol type="1">
<li>Enable MINBCFG[ENABLEB] = 1</li>
<li>Select MINDBCFG[SELB] = 0 i.e. EPWMxB_DE.sclk</li>
<li>MINDBCFG[INVERTB] = 1 i.e. inversion of the reference signal going inside the Delay logic block</li>
<li>MINDBCFG[DELAYB] = 3000 i.e. 3000 * SYSCLK (5ns) = 15 Us (3000 * SYSCLK (4ns) = 12 Us in case of AM261X-LP)</li>
<li>Select Block B as the blocking signal. MINDBCFG[SELBLOCKB] = 0</li>
<li>MINDBCFG[POLSELB] = 0 i.e. AND EPWMxA_DE with the inverted selected block signal (BLOCKB)</li>
</ol>
<p>The first waveform shows the signal before entering into the MINDB logic block. The second one shows the BLOCK signal which is the falling edge stretched and inverted version of the reference signal. The third shows inverted BLOCK signal AND-ed with the original signal to get a shift in the rising edge (marked in green). The value of it is 15 Us (12 Us in case of AM261X-LP).</p>
<h2><a class="anchor" id="autotoc_md2356"></a>
Add rising edge delay wrt falling edge of other channel of same instance</h2>
<p>We can delay the occurrence of rising edge of one signal wrt the falling edge of another signal.</p>
<p> <style>div.image img[src="am263_epwm_mdl_red_wrt_falling.PNG"]{width:60%}</style> </p><div class="image">
<img src="am263_epwm_mdl_red_wrt_falling.PNG" alt=""/>
<div class="caption">
Figure 3.a EPWM showing rising edge delay wrt other channel of same instance</div></div>
<p>In our example, EPWM1A/B are used as the references for comparing with EPWM0A/B. EPWM1A/B have all configurations same as EPWM0A/B but with MDL disabled.</p>
<p>In this case, the upper 2 signals show channel A and B output before entering the MDL logic. They are complementary to each other. With help of MDL, we can delay the rising of B by some amount wrt falling edge of A (marked in blue). Similarly, we can delay the rising of A by some amount wrt falling edge of B (marked in orange). In order to achieve this, we can do the following configuration: For output channel A:</p><ol type="1">
<li>Enable MINBCFG[ENABLEA] = 1</li>
<li>Select MINDBCFG[SELA] = 0 i.e. EPWMxA_DE.sclk</li>
<li>MINDBCFG[INVERTA] = 0 i.e. no inversion of the reference signal going inside the Delay logic block</li>
<li>MINDBCFG[DELAYA] = 2000 i.e. 2000 * SYSCLK (5ns) = 10 Us (2000 * SYSCLK (4ns) = 8 Us in case of AM261X-LP)</li>
<li>Select Block B as the blocking signal. MINDBCFG[SELBLOCKA] = 1</li>
<li>MINDBCFG[POLSELA] = 0 i.e. AND EPWMxA_DE with the inverted selected block signal (BLOCKB) For output channel B:</li>
</ol>
<ol type="1">
<li>Enable MINBCFG[ENABLEB] = 1</li>
<li>Select MINDBCFG[SELB] = 0 i.e. EPWMxB_DE.sclk</li>
<li>MINDBCFG[INVERTB] = 0 i.e. no inversion of the reference signal going inside the Delay logic block</li>
<li>MINDBCFG[DELAYB] = 2000 i.e. 2000 * SYSCLK (5ns) = 10 Us (2000 * SYSCLK (4ns) = 8 Us in case of AM261X-LP)</li>
<li>Select Block A as the blocking signal. MINDBCFG[SELBLOCKB] = 1</li>
<li>MINDBCFG[POLSELB] = 0 i.e. AND EPWMxA_DE with the inverted selected block signal (BLOCKA)</li>
</ol>
<p>For better understanding on how the block signal A is applied on output channel B, the below diagram can be referred.</p>
<p> <style>div.image img[src="am263_epwm_mdl_red_wrt_falling_block.PNG"]{width:60%}</style> </p><div class="image">
<img src="am263_epwm_mdl_red_wrt_falling_block.PNG" alt=""/>
<div class="caption">
Figure 3.b EPWM showing how block signal is applied</div></div>
<p>The second waveform shows the block signal: which is the falling edge stretched of reference signal i.e. EPWM0A before entering MDL and then inverting it. This is then AND-ed with EPWM0B to get the forth waveform i.e. EPWM0B after MDL.</p>
<h2><a class="anchor" id="autotoc_md2357"></a>
Add rising edge wrt rising edge of other channel  of same instance</h2>
<p>Delay the rising edge wrt the rising edge of the other channel.</p>
<p> <style>div.image img[src="am263_epwm_mdl_red_wrt_rising.PNG"]{width:60%}</style> </p><div class="image">
<img src="am263_epwm_mdl_red_wrt_rising.PNG" alt=""/>
<div class="caption">
Figure 4.a EPWM showing rising edge delay wrt other channel of same instance</div></div>
<p>In our example, EPWM3A/B are used as the references for comparing with EPWM4A/B. EPWM3A/B have all configurations same as EPWM4A/B but with MDL disabled.</p>
<p>This is similar to Case 2 where the Block signal is applied on itself but here EPWMxB can use the BLOCKA as its blocking signal.</p>
<h2><a class="anchor" id="autotoc_md2358"></a>
Add delay wrt other channel of other instance</h2>
<p>Till now all cases were based on channel A and B of the same epwm instance. This case shows that we can even add delay wrt to signal of some other output channel belonging to some other instance.</p>
<p> <style>div.image img[src="am263_epwm_mdl_delay_wrt_instance_connection.PNG"]{width:60%}</style> </p><div class="image">
<img src="am263_epwm_mdl_delay_wrt_instance_connection.PNG" alt=""/>
<div class="caption">
Figure 5.a MDLXBar connection between EPWM3 and EPWM6</div></div>
<p> <style>div.image img[src="am263_epwm_mdl_delay_wrt_instance.PNG"]{width:60%}</style> </p><div class="image">
<img src="am263_epwm_mdl_delay_wrt_instance.PNG" alt=""/>
<div class="caption">
Figure 5.b EPWM showing delay wrt channel of other instance</div></div>
<p>The second waveform is generated by EPWM6B.</p>
<p>The EPWM6_A before entering into MDL is shown in the second waveform. Inside EPWM6_A, we have taken the reference signal for block signal as EPWM3_A (the first waveform). Then added delay of 4000 i.e. 20 Us wrt falling edge of EPWM3_A. The rising edge of EPWM6_A occurs only after this delay. Till then it is pulled low by the BLOCK signal. We select EPWM3A_sclk as the output for MDLXBAR_1.</p><ol type="1">
<li>Enable MINBCFG[ENABLEA] = 1</li>
<li>Select MINDBCFG[SELA] = 1 i.e. Output from MDLXBar_1 (which routes the EPWM3A_sclk)</li>
<li>MINDBCFG[INVERTA] = 0 i.e. no inversion of the reference signal going inside the Delay logic block</li>
<li>MINDBCFG[DELAYA] = 4000 i.e. 4000 * SYSCLK (5ns) = 20 Us (4000 * SYSCLK (4ns) = 16 Us in case of AM261X-LP)</li>
<li>Select Block A as the blocking signal. MINDBCFG[SELBLOCKA] = 0</li>
<li>MINDBCFG[POLSELA] = 0 i.e. AND EPWMxA_DE with the inverted selected block signal (BLOCKB)</li>
</ol>
<h1><a class="anchor" id="autotoc_md2359"></a>
External Connections</h1>
<ul>
<li>EPWM0_A/B pin can be connected to an oscilloscope to view the waveform.</li>
<li>EPWM1_A, pin can be connected to an oscilloscope to view the waveform.</li>
<li>EPWM2_B, pin can be connected to an oscilloscope to view the waveform.</li>
<li>EPWM3_A/B, pin can be connected to an oscilloscope to view the waveform.</li>
<li>EPWM4_A/B, pin can be connected to an oscilloscope to view the waveform.</li>
<li>EPWM6_A/B, pin can be connected to an oscilloscope to view the waveform.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2360"></a>
AM263X-CC or AM263PX-CC or AM261X-SOM</h2>
<p>When using AM263x-CC, AM263Px-CC or AM261x-SOM with TMDSHSECDOCK (HSEC180 controlCARD Baseboard Docking Station)</p><ul>
<li>Connect HSEC pin 49, 51 to scope for EPWM0A(B)</li>
<li>Connect HSEC pin 53, 55 to scope for EPWM1A(B)</li>
<li>Connect HSEC pin 50, 52 to scope for EPWM2A(B)</li>
<li>Connect HSEC pin 54, 56 to scope for EPWM3A(B)</li>
<li>Connect HSEC pin 57, 59 to scope for EPWM4A(B)</li>
<li>Connect HSEC pin 58, 60 to scope for EPWM6A(B)</li>
</ul>
<h2><a class="anchor" id="autotoc_md2361"></a>
AM263X-LP or AM263PX-LP</h2>
<ul>
<li>Connect J2/J4 pin 11, J6/J8 pin 59 to scope for EPWM0A(B)</li>
<li>Connect J2/J4 pin 37, 38 to scope for EPWM1A(B)</li>
<li>Connect J2/J4 pin 39, 40 to scope for EPWM2A(B)</li>
<li>Connect J6/J8 pin 77, 78 to scope for EPWM3A(B)</li>
<li>Connect J6/J8 pin 75, 76 to scope for EPWM9A(B)</li>
<li>Connect J6/J8 pin 53, 57 to scope for EPWM12A(B)</li>
</ul>
<h2><a class="anchor" id="autotoc_md2362"></a>
AM261X-LP</h2>
<ul>
<li>Connect J6/J8 pin 76, 75 to scope for EPWM7A(B)</li>
<li>Connect J5/J7 pin 69, 63 to scope for EPWM1A(B)</li>
<li>Connect J2/J4 pin 40, 39 to scope for EPWM2A(B)</li>
<li>Connect J2/J4 pin 38, 37 to scope for EPWM3A(B)</li>
<li>Connect J2/J4 pin 36, 35 to scope for EPWM4A(B)</li>
<li>Connect J6/J8 pin 78, 77 to scope for EPWM6A(B)</li>
</ul>
<h1><a class="anchor" id="EXAMPLES_DRIVERS_EPWM_MINIMUM_DEADBAND_COMBOS"></a>
Supported Combinations</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter  </th><th class="markdownTableHeadNone">Value   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CPU + OS  </td><td class="markdownTableBodyNone">r5fss0-0 nortos   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Toolchain  </td><td class="markdownTableBodyNone">ti-arm-clang   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Board  </td><td class="markdownTableBodyNone">am263x-cc, am263x-lp   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Example folder  </td><td class="markdownTableBodyNone">examples/drivers/epwm/epwm_minimum_deadband/   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md2363"></a>
Steps to Run the Example</h1>
<ul>
<li><b>When using CCS projects to build</b>, import the CCS project for the required combination and build it using the CCS project menu (see <a class="el" href="CCS_PROJECTS_PAGE.html">Using SDK with CCS Projects</a>).</li>
<li><b>When using makefiles to build</b>, note the required combination and build using make command (see <a class="el" href="MAKEFILE_BUILD_PAGE.html">Using SDK with Makefiles</a>)</li>
<li>Establish connections as mentioned in External Connections section</li>
<li>Launch a CCS debug session and run the executable, see <a class="el" href="CCS_LAUNCH_PAGE.html">CCS Launch, Load and Run</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md2364"></a>
See Also</h1>
<p><a class="el" href="DRIVERS_EPWM_PAGE.html">EPWM</a></p>
<h1><a class="anchor" id="autotoc_md2365"></a>
Sample Output</h1>
<p>Shown below is a sample output when the application is run,</p>
<div class="fragment"><div class="line">EPWM Minimum Deadband Test Started ...</div>
<div class="line">App will wait for 60 seconds</div>
<div class="line">EPWM Minimum Deadband Test Passed!!</div>
<div class="line">All tests have passed!!</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md2366"></a>
References</h1>
<p> <style>div.image img[src="am263_epwm_mdl_icl_blockdiagram.PNG"]{width:60%}</style> </p><div class="image">
<img src="am263_epwm_mdl_icl_blockdiagram.PNG" alt=""/>
<div class="caption">
Figure 6.a Block diagram for MDL</div></div>
<p><br  />
<br  />
 <style>div.image img[src="am263_epwm_mdl_reference1.PNG"]{width:60%}</style> </p><div class="image">
<img src="am263_epwm_mdl_reference1.PNG" alt=""/>
<div class="caption">
Figure 6.b Understanding PWMxA(B).sclk</div></div>
<p> <br  />
<br  />
PWMxA.sclk and PWMxB.sclk are tapped from the EPWM modules. These two signals are PWM signals which are tapped before the signals pass through the high resolution delay lines. <br  />
 <style>div.image img[src="am263_epwm_mdl_reference2.PNG"]{width:60%}</style> </p><div class="image">
<img src="am263_epwm_mdl_reference2.PNG" alt=""/>
<div class="caption">
Figure 6.c Understanding the difference b/w DEPWMxA(B).sclk and DEPWMxA(B)</div></div>
<p>In our case, DEPWMA(B), DEPWMA(B).sclk are driven by PWMA(B) and PWMA(B).sclk respectively. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
