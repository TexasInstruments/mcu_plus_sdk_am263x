<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<title>AM263x MCU+ SDK: Enabling Real Time Debug</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
  /* @license-end */
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="AM263x MCU+ SDK"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AM263x MCU+ SDK
   &#160;<span id="projectnumber">11.00.00</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.html" method="get">
              <img id="MSearchSelect" src="search/mag.svg" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('REAL_TIME_DEBUG_SUPPORT_GUIDE.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Enabling Real Time Debug </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md741">Introduction</a></li>
<li class="level1"><a href="#autotoc_md742">Confirm CCS Features</a></li>
<li class="level1"><a href="#autotoc_md743">Create Target Configuration File</a></li>
<li class="level1"><a href="#autotoc_md744">Add Serial Command Monitor Software</a></li>
<li class="level1"><a href="#autotoc_md745">Launch Real Time Debug</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_developer_guides_real_time_debug"></a></p>
<h1><a class="anchor" id="autotoc_md741"></a>
Introduction</h1>
<p>With Real time debug, global variables can be added to expression window in CCS and read/written during continuous run of the program. It is enabled by UART connection between CCS and SOC. The connection is built by debug program in the listed files.</p>
<ul>
<li>Serial_Cmd_Monitor.c</li>
<li>Serial_Cmd_Monitor.h</li>
<li>Serial_Cmd_HAL.c</li>
<li>Serial_Cmd_HAL.h</li>
</ul>
<p>Even though there are four files listed here, there are only two functions required in application program. One is "SerialCmd_init()" called in initialization and the other is "SerialCmd_read()" called in background loop of BareMetal or low priority task of RTOS. This section focus on how to create the UART connection and how to launch real time debug in CCS.</p>
<h1><a class="anchor" id="autotoc_md742"></a>
Confirm CCS Features</h1>
<p>It is recommended to check the following CCS driver file if the CCS version is older than 11.1. The configuration of Cortex_R5 should be similar to below figure. If any line is missing, it is necessary to add the line showing in Figure. As for content of the lines, COM Port and Baud Rate need to be updated in target configuration file, which is included in the next step.</p>
<ul>
<li>ccs\ccs_base\common\targetdb\drivers\gti_uart_driver.xml</li>
</ul>
<div class="fragment"><div class="line">&lt;isa Type=&quot;Cortex_R5&quot; ProcID=&quot;0x75803400&quot;&gt;</div>
<div class="line">    &lt;driver file=&quot;../../../DebugServer/drivers/XPCOMToGTIAdapter.dvr&quot;&gt;</div>
<div class="line">        &lt;property Type=&quot;stringfield&quot; Value=&quot;COM14&quot; id=&quot;COM Port&quot; /&gt;</div>
<div class="line">        &lt;property Type=&quot;stringfield&quot; Value=&quot;9600&quot; id=&quot;Baud Rate&quot; /&gt;</div>
<div class="line">        &lt;property Type=&quot;hiddenfield&quot; Value=&quot;Little Endian&quot; id=&quot;Endianness&quot; /&gt;</div>
<div class="line">        &lt;property Type=&quot;hiddenfield&quot; Value=&quot;32&quot; id=&quot;Word Size Page 0&quot; /&gt;</div>
<div class="line">        &lt;property Type=&quot;hiddenfield&quot; Value=&quot;8&quot; id=&quot;Minimum Addressable Size Page 0&quot; /&gt;</div>
<div class="line">        &lt;property Type=&quot;hiddenfield&quot; Value=&quot;@ti.com/UARTMonitor;1&quot; id=&quot;XPCOM Class ID&quot; /&gt;</div>
<div class="line">        &lt;property Type=&quot;hiddenfield&quot; Value=&quot;Flash DLL Delegate&quot; id=&quot;TargetAccess&quot; /&gt;</div>
<div class="line">        &lt;connectionType Type=&quot;UARTConnection&quot;/&gt;</div>
<div class="line">    &lt;/driver&gt;</div>
<div class="line">&lt;/isa&gt;</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md743"></a>
Create Target Configuration File</h1>
<p>For a control card in below Figure, it offers both JTAG and UART ports in one USB port. Details on hardware connection can be found in AM263X Control Card User's Guide. It is necessary to create a target configuration file for the debug ports. A step-to-step guide is given below. A target configuration file is created and then configured with both JTAG and UART. The UART COM Port in target configuration should match PC Device Manager COM Port for JTAG probe Application/User UART. The Baud Rate in target configuration should be consistent with SoC UART Baud Rate configured in next step.</p>
<p> <style>div.image img[src="evm_overview_3.png"]{width:80%}</style> </p><div class="image">
<img src="evm_overview_3.png" alt=""/>
<div class="caption">
AM263X Control Card</div></div>
<ul>
<li><b>Step 1</b>: Creating a new Target configuration file for the SOC.</li>
</ul>
<p> <style>div.image img[src="new_target_config.png"]{width:40%}</style> </p><div class="image">
<img src="new_target_config.png" alt=""/>
<div class="caption">
Create New Target Configuration File</div></div>
<ul>
<li><b>Step 2</b>: Select proper JTAG connection and Device in Basic configuration.</li>
</ul>
<p> <style>div.image img[src="jtag_and_device.png"]{width:60%}</style> </p><div class="image">
<img src="jtag_and_device.png" alt=""/>
<div class="caption">
Select JTAG Connection and Device</div></div>
<ul>
<li><b>Step 3</b>: Add UART communication port for UART monitor as shown below.</li>
</ul>
<p> <style>div.image img[src="add_uart_port.png"]{width:60%}</style> </p><div class="image">
<img src="add_uart_port.png" alt=""/>
<div class="caption">
Add UART Communication Port</div></div>
<ul>
<li><b>Step 4</b>: Open Advanced target configuration and add "Cortex_R5" as component.</li>
</ul>
<p> <style>div.image img[src="adv_target_config.png"]{width:80%}</style> </p><div class="image">
<img src="adv_target_config.png" alt=""/>
<div class="caption">
Open Advanced Target Configuration</div></div>
<p> <style>div.image img[src="add_component.png"]{width:40%}</style> </p><div class="image">
<img src="add_component.png" alt=""/>
<div class="caption">
Add Component</div></div>
<ul>
<li><b>Step 5</b>: Update the COM PORT and Baud Rate for the component. UART COM port can be located as shown in the next step. The Baud rate should be same as for the UART configured in SOC.</li>
</ul>
<p> <style>div.image img[src="update_cpu_properties.png"]{width:60%}</style> </p><div class="image">
<img src="update_cpu_properties.png" alt=""/>
<div class="caption">
Select CPU Properties</div></div>
<ul>
<li><b>Step 6</b>: Find the XDS110 UART COM port from device manager.</li>
</ul>
<p> <style>div.image img[src="uart_com_port.png"]{width:60%}</style> </p><div class="image">
<img src="uart_com_port.png" alt=""/>
<div class="caption">
Find XDS110 UART COM Port</div></div>
<h1><a class="anchor" id="autotoc_md744"></a>
Add Serial Command Monitor Software</h1>
<p>There are multiple ways to use UART0 as a debug interface. They are Debug Log and Serial Command Monitor. Debug Log is a built-in tool located at Driver Porting Layer of SDK. Like Serial Cmd Monitor, its function must be located out of interrupt callback. It is a handy tool enabling string input and output. But, input and output go through UART console only. There is no built-in GUI like Expression Window and Graph in CCS. It is recommended to disable UART0 in Debug Log SysCfg as shown below and configure UART0 instance for Serial Command Monitor. As the name of UART instance in Sysconfig "CONFIG_UART_CONSOLE", matches the instance name in "Serial_Cmd_HAL.c", it not necessary to modify the two functions required by initialization and background loop. They can be simply inserted into any application.</p>
<p> <style>div.image img[src="disable_uart_log.png"]{width:40%}</style> </p><div class="image">
<img src="disable_uart_log.png" alt=""/>
<div class="caption">
Disable UART Log in Debug Log</div></div>
<p> <style>div.image img[src="configure_uart_instance.png"]{width:40%}</style> </p><div class="image">
<img src="configure_uart_instance.png" alt=""/>
<div class="caption">
Configure UART0 Instance</div></div>
<h1><a class="anchor" id="autotoc_md745"></a>
Launch Real Time Debug</h1>
<p>After building the program, debug window should be opened with the target configuration file created above. If the created target configuration file is not already opened, it can be located by following figure and looking into "User Defined" folder of the "Target Configuration" window.</p>
<p> <style>div.image img[src="locate_target_config.png"]{width:20%}</style> </p><div class="image">
<img src="locate_target_config.png" alt=""/>
<div class="caption">
Locate Target Configuration File</div></div>
<p>The created target configuration file should be under folder named as "User Defined". After right click on the file, a menu shows up and there is a option "Launch Selected Configuration" as shown below.</p>
<p> <style>div.image img[src="launch_target_config.png"]{width:40%}</style> </p><div class="image">
<img src="launch_target_config.png" alt=""/>
<div class="caption">
Launch Selected Configuration</div></div>
<p>Then, debug window shows up. The steps to connect target, load image and run via JTAG can be found in many CCS tutorials. The processor must be running continuously before connecting to UART. As the UART connection is based on continuous operation of the program, UART connection will be broken and CCS will be frozen by Break-point, Suspend, Terminate or any other events stopping the Serial Command Monitor program from running. Sometimes, it is just a habit to use those features when they are available. It is recommended to disconnect target via JTAG as shown below while using UART connection.</p>
<p> <style>div.image img[src="disconnect_jtag.png"]{width:60%}</style> </p><div class="image">
<img src="disconnect_jtag.png" alt=""/>
<div class="caption">
Disconnect JTAG Connection</div></div>
<p>When the processor is running, UART connection can be established by simply select the UART connection → Run → Load → Load Symbols as shown below.</p>
<p> <style>div.image img[src="establish_uart_connection.png"]{width:80%}</style> </p><div class="image">
<img src="establish_uart_connection.png" alt=""/>
<div class="caption">
Establish UART Connection</div></div>
<p>Expression window can be opened from View -&gt; Expressions. Global variables can be added by clicking on "Add button". Continuous refresh can be enabled for the value to get continuously updated in CCS.</p>
<p> <style>div.image img[src="expression_value.png"]{width:40%}</style> </p><div class="image">
<img src="expression_value.png" alt=""/>
<div class="caption">
Observe the global variable in CCS</div></div>
 </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
