<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<title>AM263x MCU+ SDK: SENT Decoder Example</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
  /* @license-end */
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="AM263x MCU+ SDK"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AM263x MCU+ SDK
   &#160;<span id="projectnumber">11.00.00</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.html" method="get">
              <img id="MSearchSelect" src="search/mag.svg" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('EXAMPLES_SENT_DECODER.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">SENT Decoder Example </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md3240">Introduction</a></li>
<li class="level1"><a href="#autotoc_md3241">SENT Signal</a></li>
<li class="level1"><a href="#autotoc_md3242">Supported Combinations</a><ul><li class="level2"><a href="#autotoc_md3243">HW Setup</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md3244">Steps to Run the Example</a><ul><ul><li class="level3"><a href="#autotoc_md3245">Sample Output</a></li>
</ul>
</ul>
</li>
<li class="level1"><a href="#autotoc_md3246">Steps to modify SENT decoder PRU Firmware</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_examples_pru_io_sent_decoder"></a></p>
<h1><a class="anchor" id="autotoc_md3240"></a>
Introduction</h1>
<p>The Single Edge Nibble Transmission protocol is a unidirectional communications method that connects the sensor/transmitting device and the controller/receiving device without the use of a coordination signal from the controller/receiving device. It is intended for usage in situations where high-resolution data must be transferred from a sensor to an engine control unit (ECU). It serves as a simpler, less expensive alternative to CAN, LIN, or PSI5 as well as a replacement for lesser resolution techniques such as traditional sensors that provide analog output voltage and PWM. Automotive applications for SENT-compatible sensor devices include applications for pedal sensing, mass airflow sensing, pressure sensing, temperature sensing, humidity sensing, and many others.</p>
<p> <style>div.image img[src="SENT_Intro.png"]{width:60%}</style> </p><div class="image">
<img src="SENT_Intro.png" alt=""/>
<div class="caption">
SENT Signal</div></div>
<p><b>The SENT decoder Example is a reference for software based implementation of SAE J2716. PRU ICSS firmware enables SENT decoder interface on TI Sitara AM263x processor.</b> This example does following: configures pin mux, sets soc mux to enable gpio mode for ICSS, initializes PRU, DMEM and PRU INTC module, downloads crc look up table in PRU Data RAM, and extracts sent decoded signal to UART terminal.</p>
<h1><a class="anchor" id="autotoc_md3241"></a>
SENT Signal</h1>
<p>The sensor sends out a signal that is made up of a string of pulses with data encoded as falling to falling edge periods. It happens independently of any receiver module activity and takes place without the receiver module sending a synchronization signal. The modulated signal with a constant amplitude voltage and an evaluation of the time interval between two falling edges (a single edge) is delivered in units of 4 bits (1 nibble), which can represent values ranging from 0 to 15. According to the SAE J2716 specification, a transmitter-specific nominal clock period that is used to quantify the pulse period (tick time) can be between 3-90 ms. The sensor device can use low-cost RC oscillators because the maximum permitted clock deviation is 20% from the normal tick time. The specified tick time, the sent data value, and the message time of a SENT message determine its duration. The following pulses (all with nominal timings) make up the transmitting sequence:</p>
<ol type="1">
<li>Synchronization/calibration pulse, first (56 clock ticks)</li>
<li>A single pulse with a 4 bit Status and Serial Communication header (12 to 27 clock ticks)</li>
<li>A series of one to six data nibble pulses, each reflecting the values of the signal(s) to be conveyed and lasting 12 to 27 clock ticks. Since the trailing falling edge of the SENT transmission CRC nibble also serves as the leading falling edge of the subsequent SENT transmission synchronization/calibration pulse, the number of nibbles will be fixed for each application of the encoding scheme (such as throttle position sensors, mass air flow, etc.).</li>
<li>One 4-bit checksum(CRC) nibble pulse (12 to 27 clock ticks)</li>
<li>One optional pause pulse</li>
</ol>
<p> <style>div.image img[src="sent_signal.png"]{width:60%}</style> </p><div class="image">
<img src="sent_signal.png" alt=""/>
<div class="caption">
SENT Signal</div></div>
<h1><a class="anchor" id="autotoc_md3242"></a>
Supported Combinations</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter  </th><th class="markdownTableHeadNone">Value   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">ICSSM  </td><td class="markdownTableBodyNone">ICSSM   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Toolchain  </td><td class="markdownTableBodyNone">pru-cgt   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Board  </td><td class="markdownTableBodyNone">am263x-cc   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Example folder  </td><td class="markdownTableBodyNone">examples/pru_io/sent/decoder/decoder_example   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md3243"></a>
HW Setup</h2>
<p> <style>div.image img[src="sent_hw_setup1.jpg"]{width:60%}</style> </p><div class="image">
<img src="sent_hw_setup1.jpg" alt=""/>
<div class="caption">
Encoder setup </div></div>
<p>  <style>div.image img[src="sent_hw_setup3.jpg"]{width:60%}</style> </p><div class="image">
<img src="sent_hw_setup3.jpg" alt=""/>
<div class="caption">
Decoder setup</div></div>
<p>  <style>div.image img[src="sent_hw_setup2.jpg"]{width:60%}</style> </p><div class="image">
<img src="sent_hw_setup2.jpg" alt=""/>
<div class="caption">
Encoder+Decoder Setup</div></div>
<ul>
<li>Requirement: Two <a href="https://www.ti.com/tool/TMDSCNCD263">AM263x CC </a> with <a href="https://www.ti.com/tool/TMDSHSECDOCK">HSECDOCK </a></li>
</ul>
<p>Connect the following pins of HSECDOCK as shown in the below image </p><div class="fragment"><div class="line">PR0_PRU0_GPIO0 -&gt; PR0_PRU0_GPIO0 (Pin no. 125)</div>
<div class="line">PR0_PRU0_GPIO1 -&gt; PR0_PRU0_GPIO1 (Pin no. 126)</div>
<div class="line">PR0_PRU0_GPIO2 -&gt; PR0_PRU0_GPIO2 (Pin no. 127)</div>
<div class="line">PR0_PRU0_GPIO3 -&gt; PR0_PRU0_GPIO3 (Pin no. 128)</div>
<div class="line">PR0_PRU0_GPIO4 -&gt; PR0_PRU0_GPIO4 (Pin no. 124)</div>
<div class="line">PR0_PRU0_GPIO5 -&gt; PR0_PRU0_GPIO5 (Pin no. 108)</div>
<div class="line">PR0_PRU0_GPIO6 -&gt; PR0_PRU0_GPIO6 (Pin no. 123)</div>
<div class="line">PR0_PRU0_GPIO8 -&gt; PR0_PRU0_GPIO8 (Pin no. 122)</div>
<div class="line">Ground Pin(Any) -&gt; Ground Pin(Any) [To Make sure both boards are having common ground]</div>
</div><!-- fragment --><p> <style>div.image img[src="sent_decoder_pins_config.png"]{width:60%}</style> </p><div class="image">
<img src="sent_decoder_pins_config.png" alt=""/>
<div class="caption">
HW setup</div></div>
<h1><a class="anchor" id="autotoc_md3244"></a>
Steps to Run the Example</h1>
<ul>
<li><b>When using CCS projects to build</b>, Import sent_decoder_r5f project from the above mentioned Example folder path.</li>
<li>Build the &#160;projects.</li>
<li>Load R5F project, run it. Decoder setup is now ready.</li>
<li>We will be validating decoder demo using SENT encoder example. Next step is to setup sent encoder follow the steps mentioned in <a class="el" href="EXAMPLES_SENT_ENCODER.html">SENT Encoder Example</a>.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Prerequisite: <a href="https://www.ti.com/tool/PRU-CGT">PRU-CGT-2-3</a> (ti-pru-cgt) should be installed at: <code>C:/ti/</code></dd></dl>
<ul>
<li>Launch a CCS debug session and run the executable, see <a class="el" href="CCS_LAUNCH_PAGE.html">CCS Launch, Load and Run</a></li>
<li>Open a UART terminal and use config menu to view received SENT frames <a class="el" href="EVM_SETUP_PAGE.html#CCS_UART_TERMINAL">Setup UART Terminal</a> </li>
</ul>
<h3><a class="anchor" id="autotoc_md3245"></a>
Sample Output</h3>
<div class="fragment"><div class="line">******************SENT DECODER Application**********************</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">SENT PRU-ICSS firmware loaded and running</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">******************CHANNEL0 SENT DATA**********************</div>
<div class="line"> </div>
<div class="line">Number of Frames received:       9</div>
<div class="line">Channel0 calculated tick period:         538 ns</div>
<div class="line">channel0 StatusComm Data:        08</div>
<div class="line">Channel0:  Data0 Data1 Data2 Data3 Data4 Data5 CRC</div>
<div class="line">Value:    07     04      08      07      04      08      03</div>
<div class="line">**********************************************************</div>
<div class="line"> </div>
<div class="line">******************CHANNEL1 SENT DATA**********************</div>
<div class="line"> </div>
<div class="line">Number of Frames received:       9</div>
<div class="line">Channel0 calculated tick period:         538 ns</div>
<div class="line">channel0 StatusComm Data:        08</div>
<div class="line">Channel0:  Data0 Data1 Data2 Data3 Data4 Data5 CRC</div>
<div class="line">Value:    07     04      08      07      04      08      03</div>
<div class="line">**********************************************************</div>
<div class="line"> </div>
<div class="line">******************CHANNEL2 SENT DATA**********************</div>
<div class="line"> </div>
<div class="line">Number of Frames received:       9</div>
<div class="line">Channel0 calculated tick period:         538 ns</div>
<div class="line">channel0 StatusComm Data:        08</div>
<div class="line">Channel0:  Data0 Data1 Data2 Data3 Data4 Data5 CRC</div>
<div class="line">Value:    07     04      08      07      04      08      03</div>
<div class="line">**********************************************************</div>
<div class="line"> </div>
<div class="line">******************CHANNEL3 SENT DATA**********************</div>
<div class="line"> </div>
<div class="line">Number of Frames received:       9</div>
<div class="line">Channel0 calculated tick period:         538 ns</div>
<div class="line">channel0 StatusComm Data:        08</div>
<div class="line">Channel0:  Data0 Data1 Data2 Data3 Data4 Data5 CRC</div>
<div class="line">Value:    07     04      08      07      04      08      03</div>
<div class="line">**********************************************************</div>
<div class="line"> </div>
<div class="line">******************CHANNEL4 SENT DATA**********************</div>
<div class="line"> </div>
<div class="line">Number of Frames received:       9</div>
<div class="line">Channel0 calculated tick period:         538 ns</div>
<div class="line">channel0 StatusComm Data:        08</div>
<div class="line">Channel0:  Data0 Data1 Data2 Data3 Data4 Data5 CRC</div>
<div class="line">Value:    07     04      08      07      04      08      03</div>
<div class="line">**********************************************************</div>
<div class="line"> </div>
<div class="line">******************CHANNEL5 SENT DATA**********************</div>
<div class="line"> </div>
<div class="line">Number of Frames received:       9</div>
<div class="line">Channel0 calculated tick period:         538 ns</div>
<div class="line">channel0 StatusComm Data:        08</div>
<div class="line">Channel0:  Data0 Data1 Data2 Data3 Data4 Data5 CRC</div>
<div class="line">Value:    07     04      08      07      04      08      03</div>
<div class="line">**********************************************************</div>
<div class="line"> </div>
<div class="line">******************CHANNEL6 SENT DATA**********************</div>
<div class="line"> </div>
<div class="line">Number of Frames received:       9</div>
<div class="line">Channel0 calculated tick period:         538 ns</div>
<div class="line">channel0 StatusComm Data:        08</div>
<div class="line">Channel0:  Data0 Data1 Data2 Data3 Data4 Data5 CRC</div>
<div class="line">Value:    07     04      08      07      04      08      03</div>
<div class="line">**********************************************************</div>
<div class="line"> </div>
<div class="line">******************CHANNEL7 SENT DATA**********************</div>
<div class="line"> </div>
<div class="line">Number of Frames received:       9</div>
<div class="line">Channel0 calculated tick period:         538 ns</div>
<div class="line">channel0 StatusComm Data:        08</div>
<div class="line">Channel0:  Data0 Data1 Data2 Data3 Data4 Data5 CRC</div>
<div class="line">Value:    07     04      08      07      04      08      03</div>
<div class="line">**********************************************************</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd><ul>
<li>See list supported firmware design and list of supported feature : <a class="el" href="SENT.html">SENT</a></li>
</ul>
</dd></dl>
<h1><a class="anchor" id="autotoc_md3246"></a>
Steps to modify SENT decoder PRU Firmware</h1>
<p>Modification supported: Change hardcoded tick period in firmware. Current release supports only 1us tick period support in firmware. In order to modify it:</p>
<ul>
<li><b>When using CCS projects to build</b>, Import decoder_pru1_fw project from the above mentioned Example folder path.</li>
<li>In <code>main.asm</code> file modify ch0_ticktime to desired value(1000 to 3000) and accordingly modify ch0_syncpulse_min_dur = (0.8*ch0_ticktime)*56 and ch0_syncpulse_max_dur = (1.2*ch0_ticktime)*56. For example for 500ns tick period.</li>
<li>Rebuild examples\pru_io\sent\decoder\decoder_pru1_fw project</li>
<li>Rebuild examples\pru_io\sent\decoder\decoder_example</li>
<li>Load R5F updated binary, run it.</li>
</ul>
<div class="fragment"><div class="line">ch0_ticktime                .set   500</div>
<div class="line">ch0_syncpulse_min_dur       .set   400*56</div>
<div class="line">ch0_syncpulse_max_dur       .set   600*56</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
