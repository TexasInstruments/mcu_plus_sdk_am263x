<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<title>AM263x MCU+ SDK: Achieving Fast Secure Boot and Boot time calculator</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
  /* @license-end */
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="AM263x MCU+ SDK"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AM263x MCU+ SDK
   &#160;<span id="projectnumber">11.00.00</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.html" method="get">
              <img id="MSearchSelect" src="search/mag.svg" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('FAST_SECURE_BOOT.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Achieving Fast Secure Boot and Boot time calculator </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_developer_guides_fast_secure_boot"></a> </p>
<h1><a class="anchor" id="autotoc_md653"></a>
Achieving Fast Secure Boot</h1>
<h2><a class="anchor" id="autotoc_md654"></a>
Introduction</h2>
<p>This document is intended for the users who want to achieve the least secure boot time for a signed (optionally encrypted) application through Flash interface</p>
<h2><a class="anchor" id="autotoc_md655"></a>
Steps to build, flash, load and run secure applications</h2>
<ul>
<li>Make sure <b>pyelftools</b>, <b>construct</b> and <b>cryptography</b> is installed from pip. This package is required for encrypting MCELF application images.</li>
</ul>
<div class="fragment"><div class="line">pip install pyelftools construct cryptography</div>
</div><!-- fragment --><ul>
<li>Set <b>MCELF_MERGE_SEGMENTS_FLAG = false</b> and <b>MCELF_MAX_SEGMENT_SIZE = 65536(64KB)</b> in devconfig.mak file present in MCU+ SDK.</li>
<li>Build the libraries for the specific SOC in MCU+ SDK .</li>
</ul>
<div class="fragment"><div class="line">make libs DEVICE=am263x</div>
</div><!-- fragment --><p> <br  />
</p>
<ul>
<li>Build the HSM runtime firmware for the HSSE device with the command below in TIFSMCU.</li>
</ul>
<div class="fragment"><div class="line">make -s -C hsm_firmware/am263x/hsse/hsm0-0_nortos/ti-arm-clang/ all DEVICE=am263x DEVICE_TYPE=HS</div>
</div><!-- fragment --><ul>
<li>Build the fastboot SBL project which has various optimizations.</li>
</ul>
<div class="fragment"><div class="line">make -sj -c examples/drivers/boot/sbl_qspi_fastboot/am263x-cc/r5fss0-0_nortos/ti-arm-clang/ all DEVICE=am263x DEVICE_TYPE=HS</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>The HSM runtime flash address can be configured via sysconfig tool. Open the sysconfig gui for the fastboot SBL and change the <b>HSM Runtime Image Offset</b> option to the new value. The flash address must be the same in the flash writer config and the SBL sysconfig for correct SBL operation. <div class="image">
<img src="hsmrt_flash_address.png" alt="" width="50%"/>
<div class="caption">
HSM Runtime Flash Offset</div></div>
</dd></dl>
<ul>
<li>Build the application with <b>DEVICE</b> and <b>DEVICE_TYPE=HS</b> options to make a secure MCELF signed application . The extension of this application is *.mcelf.hs .</li>
</ul>
<div class="fragment"><div class="line">make -sj -c examples/hello_world/am263x-cc/r5fss0-0_nortos/ti-arm-clang/ all DEVICE=am263x DEVICE_TYPE=HS</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Make sure that application and SBL OCRAM usage is mutually exclusive <b>except</b> the vector table. This can be done by looking at the MAP files of both the SBL and Application. In case of overlap between the two, move the application to a greater address using sysconfig memory configurator tool.</dd></dl>
<ul>
<li>Set the board to UART bootmode and update the flash contents. Checkout the steps mentioned in <a class="el" href="GETTING_STARTED_FLASH.html">Flash a Hello World example</a> . &#160;&#160;<ul>
<li>Please use fast_sbl_qspi.cfg present in ${MCU_PLUS_SDK_PATH}/tools/boot/sbl_prebuilt/am263x-cc/fast_sbl_qspi.cfg&#160;.&#160;</li>
</ul>
</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>HSM runtime firmware path must be provided in this fast sbl config in addition to sbl_qspi_fastboot, application and sbl_uart_uniflash binary paths .</dd></dl>
<ul>
<li>Set the board to QSPI bootmode and reset the device.</li>
</ul>
<p>No logs are expected in sbl_qspi_fastboot since UART logging is disabled.</p>
<h1><a class="anchor" id="autotoc_md656"></a>
Component wise secure boot time measurement</h1>
<p>Secure Boot time can be measured by using GPIOs at various points of execution.</p>
<p>The points of interest for Secure Boot are:</p><ol type="1">
<li>HSMRT load request and acknowledgement<ul>
<li>This can be measured with the Hsmclient_loadHSMRtFirmwareNonBlocking function and Hsmclient_mboxRxISRNonBlocking ISR present in <b><a class="el" href="hsmclient__loadhsmrt_8c.html">hsmclient_loadhsmrt.c</a></b> in the source/security/security_common folder.</li>
</ul>
</li>
<li>Flash read call in board flash drivers.<ul>
<li>This can be measured with the functions present in <b>flash_xxxx_xspi.c</b> in the source/board/flash/xspi/ folder.</li>
</ul>
</li>
<li>HSM Authentication/Encryption request:<ul>
<li>This can be measured by toggling GPIOs in the TIFS streaming service ISRs.</li>
</ul>
</li>
</ol>
<h1><a class="anchor" id="autotoc_md657"></a>
Boot time calculator</h1>
<p>The boot time calculator can be used get an idea of the secure boot time values which can be achieved with fast boot sbls and tifs mcu. The numbers are as per SDK 10.00 version.</p>
<p>Checkout the secure boot time calculator tool <a href="../boottime_calculator/index.html">here</a> . </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
