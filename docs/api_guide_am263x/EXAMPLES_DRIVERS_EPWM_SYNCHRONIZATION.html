<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<title>AM263x MCU+ SDK: EPWM Synchronization</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
  /* @license-end */
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="AM263x MCU+ SDK"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AM263x MCU+ SDK
   &#160;<span id="projectnumber">11.00.00</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.html" method="get">
              <img id="MSearchSelect" src="search/mag.svg" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('EXAMPLES_DRIVERS_EPWM_SYNCHRONIZATION.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">EPWM Synchronization </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md2406">Introduction</a></li>
<li class="level1"><a href="#autotoc_md2407">Example Description</a></li>
<li class="level1"><a href="#autotoc_md2408">External Connections</a></li>
<li class="level1"><a href="#EXAMPLES_DRIVERS_EPWM_SYNCHRONIZATION_COMBOS">Supported Combinations</a></li>
<li class="level1"><a href="#autotoc_md2409">Steps to Run the Example</a></li>
<li class="level1"><a href="#autotoc_md2410">See Also</a></li>
<li class="level1"><a href="#autotoc_md2411">Sample Output</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_examples_drivers_epwm_synchronization"></a></p>
<h1><a class="anchor" id="autotoc_md2406"></a>
Introduction</h1>
<p>This example configures 6 instances of EPWM, with EPWM0 taken as the reference and the other five EPWM instances are phase shifted with respect to it. EPWM0, EPWM1, EPWM2 and EPWM3 are configured using Sysconfig while EPWM4 and EPWM5 are configured using a function. Additionally, functions are defined that can change the phase and duty cycle of EPWMs while they are running. In this example synchronization is achieved by providing the sync-out pulse of EPWM0 as the sync-in pulse to EPWM1, EPWM2, EPWM3, EPWM4 and EPWM5. On receiving this sync-in pulse the EPWM time-base counter will start counting from the phase shift value up until period value. Further, 6 ECAP modules are integrated in capture mode to capture the waveform in order to validate the synchronization results. These ECAP modules are also synchronized wherein the sync-in pulse are provided by the sync-out pulse of EPWM0, and they are configured to detect the event of falling edge in the EPWM waveforms</p>
<p>The sync-in options available are:</p><ol type="1">
<li>EPWMx sync-out signal where x=0,1,2..23</li>
<li>ECAPx sync-out signal where x=0,1,2..9</li>
<li>Input XBAR outx signal where x=4,20</li>
<li>TimeSync xbar pwm output x signal where x=0,1</li>
<li>FSIRX0 Trigger x signal x=0,1,2,3</li>
<li>FSIRX1 Trigger x signal x=0,1,2,3</li>
<li>FSIRX2 Trigger x signal x=0,1,2,3</li>
<li>FSIRX3 Trigger x signal x=0,1,2,3</li>
</ol>
<p>The sync-out event options available are:</p><ol type="1">
<li>Software force generated EPWM sync-out pulse</li>
<li>Counter zero event</li>
<li>Counter equal to CMPB event</li>
<li>Counter equal to CMPC event</li>
<li>Counter equal to CMPD event</li>
<li>DCA Event 1 Sync signal generates EPWM sync-out pulse</li>
<li>DCB Event 1 Sync signal generates EPWM sync-out pulse</li>
<li>Combination of one or more of above sources</li>
</ol>
<p>For this example, we have configured EPWM0 sync-out signal to be the sync-in pulse for EPWM1, EPWM2, EPWM3, EPWM4, EPWM5. This sync-out pulse is generated at the counter zero event of EPWM0. Once the other modules receive this sync-in pulse, their counter will be at the phase value configured which is 300 for EPWM1, 600 for EPWM2, 900 for EPWM3, 450 for EPWM4, 750 for EPWM5. Also the six ECAP modules are synchronized with EPWM0, by configuring their sync-in source as EPWM0 sync-out signal. The phase values for all the ECAP modules are configured to be 0. In this example, the configurations for EPWM0, EPWM1, EPWM2 and EPWM3 are done through SysConfig while the configurations for EPWM4 and EPWM5 are done through the function AppEpwmInit in the C file. Further two more functions namely AppEpwmDutyCycleUpdate and AppEpwmPhaseUpdate are defined to update the duty cycle and phase of already running PWM waveforms. Here, the load from Shadow to Active registers occur when the time-base counter reaches zero. This event varies depending on the counter-mode we have set for our EPWM modules. If the counter mode is up-count/down-count then this event occurs only once. When the counter mode is up-down count then this event occurs two times.</p>
<p> <style>div.image img[src="am263_epwm_synchronization_timebase_waveform.png"]{width:60%}</style> </p><div class="image">
<img src="am263_epwm_synchronization_timebase_waveform.png" alt=""/>
<div class="caption">
Waveform representation of phase shifted EPWM</div></div>
<h1><a class="anchor" id="autotoc_md2407"></a>
Example Description</h1>
<p>The example uses the following EPWMs to showcase the Synchronization features which includes:</p><ol type="1">
<li>CONFIG_EPWM0 - This EPWM module is taken as the reference with 0 degree phase shift</li>
<li>CONFIG_EPWM1 - This EPWM module is phase shifted by 300 TBCLK</li>
<li>CONFIG_EPWM2 - This EPWM module is phase shifted by 600 TBCLK</li>
<li>CONFIG_EPWM3 - This EPWM module is phase shifted by 900 TBCLK</li>
<li>CONFIG_EPWM4 - This EPWM module is phase shifted by 450 TBCLK</li>
<li>CONFIG_EPWM5 - This EPWM module is phase shifted by 750 TBCLK</li>
</ol>
<ol type="1">
<li>REF_CAPTURE - This ECAP module instance is used to capture falling edge event of EPWM0_A</li>
<li>ECAP1_CAPTURE - This ECAP module instance is used to capture falling edge event of EPWM1_A</li>
<li>ECAP2_CAPTURE - This ECAP module instance is used to capture falling edge event of EPWM2_A</li>
<li>ECAP3_CAPTURE - This ECAP module instance is used to capture falling edge event of EPWM3_A</li>
<li>ECAP4_CAPTURE - This ECAP module instance is used to capture falling edge event of EPWM4_A</li>
<li>ECAP5_CAPTURE - This ECAP module instance is used to capture falling edge event of EPWM5_A</li>
</ol>
<p> <style>div.image img[src="am263_epwm_synchronization_diagram.png"]{width:40%}</style> </p><div class="image">
<img src="am263_epwm_synchronization_diagram.png" alt=""/>
<div class="caption">
Block diagram of EPWM Synchronization</div></div>
<p> <style>div.image img[src="am263_epwm_synchronization_ecap_integration.png"]{width:40%}</style> </p><div class="image">
<img src="am263_epwm_synchronization_ecap_integration.png" alt=""/>
<div class="caption">
Integration of ECAP to capture EPWM waveform</div></div>
<h1><a class="anchor" id="autotoc_md2408"></a>
External Connections</h1>
<p>When using AM263x-CC or AM263Px-CC with TMDSHSECDOCK (HSEC180 controlCARD Baseboard Docking Station) Probe the following on the HSEC pins</p><ul>
<li>CONFIG_EPWM0 - EPWM 0A/0B : 49 / 51</li>
<li>CONFIG_EPWM1 - EPWM 1A/1B : 53 / 55</li>
<li>CONFIG_EPWM2 - EPWM 2A/2B : 50 / 52</li>
<li>CONFIG_EPWM3 - EPWM 3A/3B : 54 / 56</li>
<li>CONFIG_EPWM4 - EPWM 4A/4B : 57 / 59</li>
<li>CONFIG_EPWM5 - EPWM 5A/5B : 61 / 63</li>
</ul>
<p>When using AM261x-SOM with TMDSHSECDOCK (HSEC180 controlCARD Baseboard Docking Station) Probe the following on the HSEC pins</p><ul>
<li>CONFIG_EPWM0 - EPWM 0A/0B : 49 / 51</li>
<li>CONFIG_EPWM1 - EPWM 1A/1B : 53 / 55</li>
<li>CONFIG_EPWM2 - EPWM 2A/2B : 50 / 52</li>
<li>CONFIG_EPWM3 - EPWM 3A/3B : 54 / 56</li>
<li>CONFIG_EPWM4 - EPWM 4A/4B : 57 / 59</li>
<li>CONFIG_EPWM5 - EPWM 6A/6B : 58 / 60</li>
</ul>
<p>Early Access: For AM263Px-CC E1, the connections is same as that of AM263x</p>
<p>When using AM263X-LP or AM263PX-LP</p><ul>
<li>CONFIG_EPWM0 - EPWM 0A/0B : J2.11 / J6.59</li>
<li>CONFIG_EPWM1 - EPWM 1A/1B : J4.37 / J4.38</li>
<li>CONFIG_EPWM2 - EPWM 2A/2B : J4.39 / J4.40</li>
<li>CONFIG_EPWM3 - EPWM 3A/3B : J8.77 / J8.78</li>
<li>CONFIG_EPWM4 - EPWM 9A/9B : J8.75 / J8.76</li>
<li>CONFIG_EPWM5 - EPWM 13A/13B : J8.79 / J8.80</li>
</ul>
<p>When using AM261X-LP</p><ul>
<li>CONFIG_EPWM0 - EPWM 7A/7B : J8.76 / J8.75</li>
<li>CONFIG_EPWM1 - EPWM 1A/1B : J7.69 / J7.63</li>
<li>CONFIG_EPWM2 - EPWM 2A/2B : J2.40 / J2.39</li>
<li>CONFIG_EPWM3 - EPWM 3A/3B : J2.38 / J2.37</li>
<li>CONFIG_EPWM4 - EPWM 4A/4B : J2.36 / J2.35</li>
<li>CONFIG_EPWM5 - EPWM 6A/6B : J8.78 / J8.77</li>
</ul>
<h1><a class="anchor" id="EXAMPLES_DRIVERS_EPWM_SYNCHRONIZATION_COMBOS"></a>
Supported Combinations</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter  </th><th class="markdownTableHeadNone">Value   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CPU + OS  </td><td class="markdownTableBodyNone">r5fss0-0 nortos   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Toolchain  </td><td class="markdownTableBodyNone">ti-arm-clang   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Board  </td><td class="markdownTableBodyNone">am263x-cc, am263x-lp   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Example folder  </td><td class="markdownTableBodyNone">examples/drivers/epwm/epwm_synchronization   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md2409"></a>
Steps to Run the Example</h1>
<ul>
<li><b>When using CCS projects to build</b>, import the CCS project for the required combination and build it using the CCS project menu (see <a class="el" href="CCS_PROJECTS_PAGE.html">Using SDK with CCS Projects</a>).</li>
<li><b>When using makefiles to build</b>, note the required combination and build using make command (see <a class="el" href="MAKEFILE_BUILD_PAGE.html">Using SDK with Makefiles</a>)</li>
<li>Launch a CCS debug session and run the executable, see <a class="el" href="CCS_LAUNCH_PAGE.html">CCS Launch, Load and Run</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md2410"></a>
See Also</h1>
<p><a class="el" href="DRIVERS_EPWM_PAGE.html">EPWM</a></p>
<h1><a class="anchor" id="autotoc_md2411"></a>
Sample Output</h1>
<p>Shown below is a sample output when the application is run,</p>
<div class="fragment"><div class="line">EPWM Synchronization Test Started ...</div>
<div class="line">EPWM Synchronization Example runs for 5 Secs</div>
<div class="line">    Falling Edge timestamp of Reference waveform  :     1002</div>
<div class="line">    Falling Edge timestamp of EPWM1 :   702</div>
<div class="line">    Falling Edge timestamp of EPWM2 :   402</div>
<div class="line">    Falling Edge timestamp of EPWM3 :   102</div>
<div class="line">    Falling Edge timestamp of EPWM4 :   552</div>
<div class="line">    Falling Edge timestamp of EPWM5 :   252</div>
<div class="line">    Observed Phase Delay between Reference Waveform and EPWM1 Waveform :    300</div>
<div class="line">    Observed Phase Delay between Reference Waveform and EPWM2 Waveform :    600</div>
<div class="line">    Observed Phase Delay between Reference Waveform and EPWM3 Waveform :    900</div>
<div class="line">    Observed Phase Delay between Reference Waveform and EPWM4 Waveform :    450</div>
<div class="line">    Observed Phase Delay between Reference Waveform and EPWM5 Waveform :    750</div>
<div class="line">EPWM Synchronization Test Passed!!</div>
<div class="line">All tests have passed!!</div>
</div><!-- fragment --><p> <style>div.image img[src="am263_epwm_synchronization_output_waveform.png"]{width:80%}</style> </p><div class="image">
<img src="am263_epwm_synchronization_output_waveform.png" alt=""/>
<div class="caption">
EPWM Synchronization Output Waveform</div></div>
 </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
